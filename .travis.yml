language: perl
sudo: false
dist: trusty

install:
  - perlbrew list
  - cpanm -n Dist::Zilla
  - cpanm -n App::af
  - cpanm -n Alien::Build::Plugin::Probe::OverrideCI
  - env ALIEN_INSTALL_TYPE=$ALIEN_INSTALL_TYPE_CI af missing --precompile   | cpanm -n
  - env ALIEN_INSTALL_TYPE=$ALIEN_INSTALL_TYPE_CI af missing --plugin       | cpanm -n
  - env ALIEN_INSTALL_TYPE=$ALIEN_INSTALL_TYPE_CI af missing                | cpanm -n
  - env ALIEN_INSTALL_TYPE=$ALIEN_INSTALL_TYPE_CI dzil authordeps --missing | cpanm -n
  - env ALIEN_INSTALL_TYPE=$ALIEN_INSTALL_TYPE_CI dzil listdeps   --missing | cpanm -n

perl:
  - "5.14"
  - "5.16"
  - "5.18"
  - "5.20"
  - "5.22"
  - "5.24"
  - "5.26"

env:
  global:
    - ALIEN_BUILD_PRELOAD=Probe::OverrideCI
  matrix:
    - ALIEN_INSTALL_TYPE_CI=share
    - ALIEN_INSTALL_TYPE_CI=system

script:
  - dzil test -v
